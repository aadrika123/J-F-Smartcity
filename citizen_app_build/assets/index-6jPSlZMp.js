import{j as t}from"./index-A_jqfZ-9.js";import{r as p}from"./router-VubLdhT0.js";import"./reactQuery-U0SXPRnt.js";import"./reactQueryDevtools-6dm9iask.js";import"./axios-YpSsR79r.js";import"./tailwind-kPGtpyku.js";import"./reactIcons-m3sh1_3a.js";import"./reactLazyLoadImageComponent-DVjwytrh.js";import"./headlessui-PACf4Y4w.js";function j(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var s=Math.random()*16|0,n=o=="x"?s:s&3|8;return n.toString(16)})}const x="100001513",d="ePramaan",m="e0681502-a91b-4868-b8c0-4274b0144e1a",i="https://jharkhandegovernance.com/juidco-app/auth/logout-e-praman";function D(){const[o,s]=p.useState(null);return{logout:async a=>{try{const e=JSON.parse(a);console.log(e==null?void 0:e.session_id);const r=e.session_id||"",c=e.sub||"",g=j(),h=x+r+d+m+c+i,u=new TextEncoder,f=await crypto.subtle.importKey("raw",u.encode(m),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),b=await crypto.subtle.sign("HMAC",f,u.encode(h)),w=Array.from(new Uint8Array(b)).map(S=>S.toString(16).padStart(2,"0")).join(""),y={clientId:x,sessionId:r,hmac:w,iss:d,logoutRequestId:g,sub:c,redirectUrl:i,customParameter:""},l=new FormData;if(l.append("data",JSON.stringify(y)),!(await fetch("https://epramaan.meripehchaan.gov.in/openid/jwt/processOIDCSLORequest.do",{method:"POST",body:l})).ok)throw new Error("Logout failed");return{success:!0,redirectUrl:i}}catch(e){return s(e instanceof Error?e.message:"An unknown error occurred"),{success:!1,error:o}}},error:o}}function O(){const[o,s]=p.useState(localStorage.getItem("epramaanToken")||""),{logout:n,error:a}=D(),e=async r=>{r.preventDefault(),(await n(o)).success&&console.log("Logout success")};return t.jsxs("div",{className:"max-w-md mx-auto mt-10 p-6 bg-white rounded-lg shadow-xl",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Logout"}),a&&t.jsx("p",{className:"text-red-500 mb-4",children:a}),t.jsxs("form",{onSubmit:e,children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"sessionData",className:"block text-gray-700 text-sm font-bold mb-2",children:"Session Data (JWS)"}),t.jsx("textarea",{id:"sessionData",value:o,onChange:r=>s(r.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",rows:4,required:!0})]}),t.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Logout"})]})]})}export{O as default};
